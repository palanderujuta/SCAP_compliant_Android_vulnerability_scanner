<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions>
	<generator>  <!-- Information about when the file was compiled and what version of OVAL schema was used -->
		<oval:product_name>SCAP-compliant-Android-OVAL-scanner</oval:product_name> <!-- Name of the product for which the definition is being written-->
		<oval:product_version>1.0</oval:product_version>
    	<oval:schema_version>5.11.0</oval:schema_version> <!-- Version of OVAL schema against which the definition can be validated-->
    	<oval:timestamp>2017-02-22T12:12:39</oval:timestamp> <!-- Timestamp when the definition file was written-->
	</generator>

	<definitions>  <!--collection of definition which provide a means to specify what endpoint information should be checked and what corresponding values are expected to be found.-->
		<definition id="oval:org.mitre.oval:def:101" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>checking if the system is vulnerable to the "Year 2038 problem"</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 4.x before 4.4.4</platform>
					<platform>Android 5.0.x before 5.0.2</platform>
					<platform>Android 5.1.x before 5.1.1</platform>
					<platform>Android 6.x before 2016-08-01</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-3831" ref_url="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-3831"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					The telephony component in the above mentioned versions of android, allow remote attackers to cause a denial of service (device crash) through a NITZ time value of 2038-01-19 or later that is mishandled by the system clock. This is known as a "Year 2038 problem" :  an issue for computing and data storage situations in which time values are stored or calculated as a signed 32-bit integer, and this number is interpreted as the number of seconds since 00:00:00 UTC on 1 January 1970 (the epoch) 
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:102" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>

		<definition>
		</definition>

	</definitions>
	<tests>
		<telephony_test id="oval:org.mitre.oval:tst:101" check="" check_existence="" comment="Test to check if telephony exists on the operating system">
			<telephony_object object_ref="oval:org.mitre.oval:obj:101"></telephony_object>
			<telephony_state state_ref="oval:org.mitre.oval:ste:101"></telephony_state>
		</telephony_test>
	</tests>

</oval_definitions>