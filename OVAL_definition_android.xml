<?xml version="1.0" encoding="UTF-8"?>
<oval_definitions>
	<generator>  <!-- Information about when the file was compiled and what version of OVAL schema was used -->
		<product_name>SCAP-compliant-Android-OVAL-scanner</product_name> <!-- Name of the product for which the definition is being written-->
		<product_version>1.0</product_version>
    	<schema_version>5.11.0</schema_version> <!-- Version of OVAL schema against which the definition can be validated-->
    	<timestamp>2017-02-22T12:12:39</timestamp> <!-- Timestamp when the definition file was written-->
	</generator>

	<definitions>  <!--collection of definition which provide a means to specify what endpoint information should be checked and what corresponding values are expected to be found.-->
		<definition id="oval:org.mitre.oval:def:101" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>checking if the system is vulnerable to the "Year 2038 problem"</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 4.x before 4.4.4</platform>
					<platform>Android 5.0.x before 5.0.2</platform>
					<platform>Android 5.1.x before 5.1.1</platform>
					<platform>Android 6.x before 2016-08-01</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-3831" ref_url="https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-3831"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					The telephony component in the above mentioned versions of android, allow remote attackers to cause a denial of service (device crash) through a NITZ time value of 2038-01-19 or later that is mishandled by the system clock. This is known as a "Year 2038 problem" :  an issue for computing and data storage situations in which time values are stored or calculated as a signed 32-bit integer, and this number is interpreted as the number of seconds since 00:00:00 UTC on 1 January 1970 (the epoch) 
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:102" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>

		<definition id="oval:org.mitre.oval:def:201" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>privilege vulnerability in Telephony</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 6.x</platform>
					<platform>Android 7.x</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-6763" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6763"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					An elevation of privilege vulnerability in Telephony could enable a local malicious application to access system functions beyond its access level. This issue is rated as Moderate because it is a local bypass of restrictions on a constrained process. Product: Android. Versions: 6.0, 6.0.1, 7.0. Android ID: A-31566390.
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:201" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>
		<definition id="oval:org.mitre.oval:def:301" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>A denial of service vulnerability in Telephony</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 4.x before 4.4.4</platform>
					<platform>Android 5.0.x before 5.0.2</platform>
					<platform>Android 5.1.x before 5.1.1</platform>
					<platform>Android 6.x</platform>
					<platform>Android 7.x</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-6771" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6771"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					A denial of service vulnerability in Telephony could enable a local malicious application to use a specially crafted file to cause a device hang or reboot. This issue is rated as High due to the possibility of local permanent denial of service. Product: Android. Versions: 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0. Android ID: A-31530456.
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:201" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>
				<definition id="oval:org.mitre.oval:def:401" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>attackers can gain privilege via a crafted application</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 6.x before 2016-08-01</platform>
					<platform>Android 7.x</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-3922" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3922"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					libril/RilSapSocket.cpp in Telephony in Android 6.x before 2016-10-01 and 7.0 before 2016-10-01 relies on variable-length arrays, which allows attackers to gain privileges via a crafted application, aka internal bug 30202619. 
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:102" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>
		<definition id="oval:org.mitre.oval:def:501" version="1" class="vulnerability"> <!--required attributes. for id, org.mitre.oval namespace should be used. Note : this is a temporary ID. When submitted to the OVAL community,new randomly generated id is assigned from the OVAL repository. A definition is assigned Class value can be "vulnerability","compliance" ,"inventory","patch","Miscellaneous" -->
			<metadata>
				<title>Race condition in telephony allows attackers to gain privilege via a crafted application</title>
				<affected family="Android">  <!--platforms affected by this vulnerability-->
					<platform>Android 4.x before 4.4.4</platform>
					<platform>Android 5.0.x before 5.0.2, 5.1.x before 5.1.1</platform>
					<platform>Android 6.x before 2016-10-01</platform>
					<platform>Android 7.0 before 2016-10-01</platform>
				</affected>
				<reference source="CVE" ref_id="CVE-2016-3914" ref_url="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3914"/> <!--Reference of where the vulnerability details can be found-->
				<description>
					Race condition in providers/telephony/MmsProvider.java in Telephony in Android 4.x before 4.4.4, 5.0.x before 5.0.2, 5.1.x before 5.1.1, 6.x before 2016-10-01, and 7.0 before 2016-10-01 allows attackers to gain privileges via a crafted application that modifies a database between two open operations, aka internal bug 30481342.
				</description>
			</metadata>
			<notes>
				<note>
					We will need to check whether telephony exists on the system and whether the operating system is of the version mentioned in the "affected" section. If both tests return true, then the vulnerability exists on the system. 
				</note>
			</notes>
			<criteria operator="AND"> <!--this is a recursive element which can contain one or more criterias which in turn can contain criterion. The value of the 'operator' determines the final result of the test by performing the corresponding logical operation on the results of the individual tests-->
				<criterion test_ref= "oval:org.mitre.oval:tst:101" comment="Telephony exists on the operating system" />
				<criterion test_ref= "oval:org.mitre.oval:tst:102" comment="The version of the operating system is one of the versions mentioned in the 'affected platforms' section"/>
			</criteria>
		</definition>
	</definitions>

	<tests>
		<telephony_test id="oval:org.mitre.oval:tst:101" check="" check_existence="" comment="Test to check if telephony exists on the operating system">
			<object object_ref="oval:org.mitre.oval:obj:101"></object>
			<state state_ref="oval:org.mitre.oval:ste:101"></state>
		</telephony_test>
		<systemdetails_test id="oval:org.mitre.oval:tst:102" check="" check_existence="" comment="Test to know the version of OS">
			<object object_ref="oval:org.mitre.oval:obj:201"></object>
			<state state_ref="oval:org.mitre.oval:ste:201"></state>
		</systemdetails_test>
	</tests>

	<objects>
		<telephony_object id="oval:org.mitre.oval:obj:101" version="1" comment="telephonyExists">
		</telephony_object>
    	<systemdetails_object id="oval:org.mitre.oval:obj:201" version="1" comment="knowing the OS">
    	</systemdetails_object>
	</objects>

	<states>
		<telephony_state id="oval:org.mitre.oval:ste:101" version="1"> <!--Checking the network type and the country iso code to check if telephony exists on the system-->
			<network_type datatype="string" operation="equals" entity_check="all">LTE</network_type>
      		<sim_country_iso datatype="int" operation="equals" entity_check="all">1</sim_country_iso>
		</telephony_state>	
		<systemdetails_state id="oval:org.mitre.oval:ste:201" version="1"> <!--checking the version of the OS on android Operating system-->
			<os_version_codename datatype="string" operation="equals" entity_check="all">Marshmallow</os_version_codename> 
			<!--code names : Cupcake (v1.5)	Donut (v1.6),Eclair (v2.0),FroYo (v2.2),Gingerbread (v2.3),Honeycomb (v3.0), Ice Cream Sandwich (v4.0), Jelly Bean (v4.1, v4.2, v4.3), KitKat (v4.4) Lollipop (v5.0),Marshmallow (v6.0),Nougat (v7.0)-->
		</systemdetails_state>
	</states>
</oval_definitions>