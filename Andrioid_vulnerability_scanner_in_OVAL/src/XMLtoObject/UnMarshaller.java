package XMLtoObject;

import java.io.File;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import oval_def.OVAL_definitions;

public class UnMarshaller {

	static String android_oval_definition = "C:/Users/RUJUTA/Desktop/RujutaGIT/internship/OVAL-Interpretor/SCAP_compliant_Android_vulnerability_scanner/SCAP_compliant_Android_vulnerability_scanner/OVAL_definition_android.xml";
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		File file = new File(android_oval_definition);
		JAXBContext jaxbContext;
		try 
		{
			jaxbContext = JAXBContext.newInstance(OVAL_definitions.class);
			javax.xml.bind.Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();
			OVAL_definitions ovaldefinitions = (OVAL_definitions)  jaxbUnmarshaller.unmarshal(file);
			//System.out.println(ovaldefinitions);
			System.out.println("Network type: "+ ovaldefinitions.getStates().gettelephonyState().get(0).getnType().get(0).get_ntype());
			System.out.println("Platform : "+ovaldefinitions.getDefinitions().getDefinitions().get(0).getMetadata().getAffected().get(0).getPlatform().get(0));
			System.out.println("Criteria operator : "+ovaldefinitions.getDefinitions().getDefinitions().get(0).getCriteria().getOperator());
			System.out.println("Criterion test_ref : "+ovaldefinitions.getDefinitions().getDefinitions().get(0).getCriteria().getCriteria().get(0).getTestRef());		
			System.out.println("OS version code name : "+ovaldefinitions.getStates().getsystemdetails_state().get(0).getOs_version_code().get(0).getOs_version_codename());
		} 
		catch (JAXBException e) 
		{
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		

	}

}
